(this.webpackJsonpspeechstate=this.webpackJsonpspeechstate||[]).push([[0],{170:function(t,e,n){},218:function(t,e){},357:function(t,e){},360:function(t,e){},364:function(t,e){},365:function(t,e){},366:function(t,e){},367:function(t,e){},368:function(t,e){},456:function(t,e,n){"use strict";n.r(e);var r=n(166),o=n(51),c=(n(170),n(14),n(159)),u=n(25),a=n(94),i=n(3),s=n(459),l=n(460);function d(t){return Object(i.q)((function(e){return{type:"SPEAK",value:t}}))}var m={"Lecture.":{title:"Dialogue systems lecture"},"Lunch.":{title:"Lunch at the canteen"},Monday:{day:"Monday"},"Tuesday.":{day:"Tuesday"},"Wednesday.":{day:"Wednesday"},"Thursday.":{day:"Thursday"},Friday:{day:"Friday"},"At 9":{time:"nine"},"At 10":{time:"ten"},"At 11":{time:"eleven"},"At 12":{time:"twelve"},"At 1:00":{time:"one"},"At 2:00":{time:"two"},"At 3:00":{time:"three"},"At 4:00":{time:"four"},"At 5:00":{time:"five"},"At 6:00":{time:"six"},"At 7:00":{time:"seven"},"At 8:00":{time:"eight"},"Create a meeting.":{meet:"yes"},"Ask about someone.":{celebrity:"no"}},p={"Yes.":{yes_no:"yes"},"Of course.":{yes_no:"yes"},"Sure.":{yes_no:"yes"},"Absolutely.":{yes_no:"yes"},"No.":{yes_no:"no"},"No way.":{yes_no:"no"},"Of course not.":{yes_no:"no"},"Absolutely not.":{yes_no:"no"},"Help me.":{help:"help"},"Help.":{help:"help"},"I would like to help me":{help:"help"}},E={initial:"idle",states:{idle:{on:{CLICK:"init"}},init:{on:{TTS_READY:"Appointment",CLICK:"Appointment"}},Help:{initial:"help_message",states:{help_message:{entry:d("How can I help you?"),on:{ENDSPEECH:"#root.dm.Appointment.hist"}}}},Appointment:{initial:"Hej",states:{hist:{type:"history"},Hej:{initial:"prompt0",entry:Object(i.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{target:"menu",cond:function(t){return t.recResult[0].confidence>.6},actions:Object(i.b)({username:function(t){return t.recResult[0].utterance}})},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{hist:{type:"history"},prompt0:{entry:[d("What is your name?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[d("could you say your name?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[d("Please, tell me your name."),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, could you repeat?"),on:{ENDSPEECH:"ask"}}}},menu:{initial:"prompt",entry:Object(i.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{target:"welcome",cond:function(t){return"meet"in(m[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>.6},actions:Object(i.b)({meet:function(t){return m[t.recResult[0].utterance].meet}})},{target:"celebrity",cond:function(t){return"celebrity"in(m[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>.6},actions:Object(i.b)({celebrity:function(t){return m[t.recResult[0].utterance].celebrity}})},{target:".nomatch"}],TIMEOUT:[{target:".prompt",cond:function(t){return 0===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"Hi ".concat(t.username)}})),on:{ENDSPEECH:"ask"}},ask:{entry:[d("Would you like to create a meeting or ask about someone?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"yo"}},yo:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, I didn't understand that."),on:{ENDSPEECH:"ask"}}}},celebrity:{initial:"prompt0",entry:Object(i.b)({counter:function(t){return t.counter}}),on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{target:"celeb_info",cond:function(t){return t.recResult[0].confidence>.6},actions:Object(i.b)({celebrity:function(t){return t.recResult[0].utterance}})}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:d("For whom do you want to know?"),on:{ENDSPEECH:"ask"}},prompt1:{entry:d("Who are you searching for?"),on:{ENDSPEECH:"ask"}},prompt2:{entry:d("For whom do you want information?"),on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")}}},celeb_info:{invoke:{id:"famouSId",src:function(t,e){return n=t.celebrity,fetch(new Request("https://cors.eu.org/https://api.duckduckgo.com/?q=".concat(n,"&format=json&skip_disambig=1"))).then((function(t){return t.json()}));var n},onDone:{target:"meeting_with_celeb",actions:[Object(i.b)({famouS:function(t,e){return e.data.AbstractText}}),function(t,e){return console.log(t,e)}]},onError:{target:"celebrity"}}},meeting_with_celeb:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"Ok,Some information about ".concat(t.celebrity,", ").concat(t.famouS,".")}})),on:{ENDSPEECH:"you"}},you:{initial:"prompt0",entry:Object(i.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{target:"date",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"yes"===p[t.recResult[0].utterance].yes_no},actions:Object(i.b)({title:function(t){return" ".concat(t.celebrity)}})},{target:"meeting",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"no"===p[t.recResult[0].utterance].yes_no}},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:[d("Do you want to meet the celecrity}"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[d("Do you want to create this meeting?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[d("Do you want to create a meeting with the celebrity?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, what did you say?"),on:{ENDSPEECH:"ask"}}}},welcome:{entry:Object(i.q)((function(t){return{type:"SPEAK",value:"Ok!"}})),on:{ENDSPEECH:"meeting"}},meeting:{initial:"prompt0",entry:Object(i.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{target:"day",cond:function(t){return"title"in(m[t.recResult[0].utterance]||{})},actions:Object(i.b)((function(t){return{title:m[t.recResult[0].utterance].title}}))},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:[d("What is your meeting about?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[d("Tell me about your meeting"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[d("What should I call your meeting?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, I don't know that. Could you repeat?"),on:{ENDSPEECH:"ask"}}}},day:{initial:"prompt0",on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{cond:function(t){return"day"in(m[t.recResult[0].utterance]||{})},actions:Object(i.b)((function(t){return{day:m[t.recResult[0].utterance].day}})),target:"whole_day"},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:[d("On which day is it?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[d("On which day will this meeting take place?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[d("Please tell me the day of this meeting."),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, what day did you say?"),on:{ENDSPEECH:"ask"}}}},whole_day:{initial:"prompt0",entry:Object(i.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{target:"confirmation_whole_day",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"yes"===p[t.recResult[0].utterance].yes_no}},{target:"time",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"no"===p[t.recResult[0].utterance].yes_no}},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:[d("Will it take the whole day?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[d("Will the meeting take the whole day?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[d("Will the meeting take the whole day"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, I don't know what it is. Tell me something I know."),on:{ENDSPEECH:"ask"}}}},date:{initial:"prompt0",on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{cond:function(t){return"day"in(m[t.recResult[0].utterance]||{})},actions:Object(i.b)((function(t){return{day:m[t.recResult[0].utterance].day}})),target:"all_day"},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:[d("On which day is your meeting?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[d("On which day is your meeting?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[d("Could you tell which day is your meeting"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, could you repeat?"),on:{ENDSPEECH:"ask"}}}},all_day:{initial:"prompt0",entry:Object(i.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{target:"confirmation_all_day",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"yes"===p[t.recResult[0].utterance].yes_no}},{target:"time",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"no"===p[t.recResult[0].utterance].yes_no}},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:[d("Will it take the whole day?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[d("Will the meeting take the whole day?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[d("Will the meeting last the whole day?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, I don't understand."),on:{ENDSPEECH:"ask"}}}},time:{initial:"prompt0",entry:Object(i.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{cond:function(t){return"time"in(m[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>.6},actions:Object(i.b)((function(t){return{time:m[t.recResult[0].utterance].time}})),target:"confirmation_with_time"},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:[d("What time is your meeting?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[d("Could you tell me what time is your meeting?"),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[d("Please tell me what time is your meeting."),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, what time did you say?"),on:{ENDSPEECH:"ask"}}}},confirmation_whole_day:{initial:"prompt0",entry:Object(i.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{target:"meeting_created",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"yes"===p[t.recResult[0].utterance].yes_no}},{target:"time",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"no"===p[t.recResult[0].utterance].yes_no}},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:[Object(i.q)((function(t){return{type:"SPEAK",value:"Do you want me to create a meeting titled ".concat(t.title," on ").concat(t.day,"?")}})),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[Object(i.q)((function(t){return{type:"SPEAK",value:"Should I create a meeting called ".concat(t.title," on ").concat(t.day,"?")}})),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[Object(i.q)((function(t){return{type:"SPEAK",value:"Do you want me to create a meeting titled ".concat(t.title," on ").concat(t.day,"?")}})),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, I don't understand that."),on:{ENDSPEECH:"ask"}}}},confirmation_all_day:{initial:"prompt0",entry:Object(i.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{target:"meeting_created",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"yes"===p[t.recResult[0].utterance].yes_no}},{target:"time",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"no"===p[t.recResult[0].utterance].yes_no}},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:[Object(i.q)((function(t){return{type:"SPEAK",value:"Do you want me to create a meeting with ".concat(t.celebrity," on ").concat(t.day,"?")}})),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[Object(i.q)((function(t){return{type:"SPEAK",value:"Should I create a meeting with ".concat(t.celebrity," on ").concat(t.day,"?")}})),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[Object(i.q)((function(t){return{type:"SPEAK",value:"Do you want me to create a meeting with ".concat(t.celebrity," on ").concat(t.day,"?")}})),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, I don't understand that."),on:{ENDSPEECH:"ask"}}}},confirmation_with_time:{initial:"prompt0",on:{RECOGNISED:[{target:"#root.dm.Help",cond:function(t){return"help"in(p[t.recResult[0].utterance]||{})}},{target:"meeting_created",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"yes"===p[t.recResult[0].utterance].yes_no}},{target:"meeting",cond:function(t){return"yes_no"in(p[t.recResult[0].utterance]||{})&&"no"===p[t.recResult[0].utterance].yes_no}},{target:".nomatch"}],TIMEOUT:[{target:".prompt0",cond:function(t){return 0===t.counter}},{target:".prompt1",cond:function(t){return 1===t.counter}},{target:".prompt2",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt0:{entry:[Object(i.q)((function(t){return{type:"SPEAK",value:"Do you want me to create a meeting titled ".concat(t.title," on ").concat(t.day," at ").concat(t.time,"?")}})),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt1:{entry:[Object(i.q)((function(t){return{type:"SPEAK",value:"Should I create a meeting titled ".concat(t.title," on ").concat(t.day," at ").concat(t.time,"?")}})),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[Object(i.q)((function(t){return{type:"SPEAK",value:"Please tell me if you want me to create a meeting titled ".concat(t.title," on ").concat(t.day," at ").concat(t.time,".")}})),Object(i.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(i.q)("LISTEN")},nomatch:{entry:d("Sorry, I don't understand. Could you repeat?"),on:{ENDSPEECH:"ask"}}}},meeting_created:{initial:"prompt",states:{prompt:{entry:d("Ok.Your meeting has been created!")}}}}}}},y=n(160),f=n.n(y),b=n(163),g=n.n(b),S=n(12),h=u.a.send,O=u.a.cancel,j="northeurope";Object(l.a)({url:"https://statecharts.io/inspect",iframe:!1});var C=Object(a.a)({id:"root",type:"parallel",states:{dm:Object(o.a)({},E),asrtts:{initial:"init",states:{init:{on:{CLICK:{target:"getToken",actions:[Object(i.b)({audioCtx:function(t){return new(window.AudioContext||window.webkitAudioContext)}}),function(t){return navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){t.audioCtx.createMediaStreamSource(e)}))}]}}},getToken:{invoke:{id:"getAuthorizationToken",src:function(t,e){return _()},onDone:{actions:[Object(i.b)((function(t,e){return{azureAuthorizationToken:e.data}})),"ponyfillASR"],target:"ponyfillTTS"},onError:{target:"fail"}}},ponyfillTTS:{invoke:{id:"ponyTTS",src:function(t,e){return function(e,n){var r=g()({audioContext:t.audioCtx,credentials:{region:j,authorizationToken:t.azureAuthorizationToken}}),o=r.speechSynthesis,c=r.SpeechSynthesisUtterance;t.tts=o,t.ttsUtterance=c,t.tts.addEventListener("voiceschanged",(function(){t.tts.cancel();var n=t.tts.getVoices(),r=RegExp("en-US","u");r=RegExp("en-US","u");var o=n.find((function(t){return r.test(t.name)}));o?(t.voice=o,e("TTS_READY")):(console.error("TTS_ERROR: Could not get voice for regexp ".concat(r)),e("TTS_ERROR"))}))}}},on:{TTS_READY:"idle",TTS_ERROR:"fail"}},idle:{on:{LISTEN:"recognising",SPEAK:{target:"speaking",actions:Object(i.b)((function(t,e){return{ttsAgenda:e.value}}))}}},recognising:{initial:"noinput",exit:"recStop",on:{ASRRESULT:{actions:["recLogResult",Object(i.b)((function(t,e){return{recResult:e.value}}))],target:".match"},RECOGNISED:"idle",SELECT:"idle",CLICK:".pause"},states:{noinput:{entry:["recStart",h({type:"TIMEOUT"},{delay:function(t){return 1e3*(t.tdmPassivity||10)},id:"timeout"})],on:{TIMEOUT:"#root.asrtts.idle",STARTSPEECH:"inprogress"},exit:O("timeout")},inprogress:{},match:{entry:h("RECOGNISED")},pause:{entry:"recStop",on:{CLICK:"noinput"}}}},speaking:{entry:"ttsStart",on:{ENDSPEECH:"idle",SELECT:"idle",CLICK:{target:"idle",actions:h("ENDSPEECH")}},exit:"ttsStop"},fail:{}}}}},{actions:{recLogResult:function(t){console.log("U>",t.recResult[0].utterance,t.recResult[0].confidence)},logIntent:function(t){console.log("<< NLU intent: "+t.nluData.intent.name)}}}),R=function(t){var e=((t.state.context.tdmVisualOutputInfo||[{}]).find((function(t){return"name"===t.attribute}))||{}).value,n=((t.state.context.tdmVisualOutputInfo||[{}]).find((function(t){return"image"===t.attribute}))||{}).value,r="circle";switch(!0){case t.state.matches({asrtts:"fail"})||t.state.matches({dm:"fail"}):break;case t.state.matches({asrtts:{recognising:"pause"}}):e="Click to continue";break;case t.state.matches({asrtts:"recognising"}):r="circle-recognising",e=e||"Listening...";break;case t.state.matches({asrtts:"speaking"}):r="circle-speaking",e=e||"Speaking...";break;case t.state.matches({dm:"idle"}):case t.state.matches({dm:"init"}):e="Click to start!",r="circle-click";break;default:e=e||"\xa0"}return Object(S.jsxs)("div",{className:"control",children:[Object(S.jsx)("figure",{className:"prompt",children:n&&Object(S.jsx)("img",{src:n,alt:e})}),Object(S.jsxs)("div",{className:"status",children:[Object(S.jsx)("button",Object(o.a)({type:"button",className:r,style:{}},t)),Object(S.jsx)("div",{className:"status-text",children:e})]})]})},T=function(t){var e=t.alternative.find((function(t){return"name"===t.attribute})).value,n=(t.alternative.find((function(t){return"image"===t.attribute}))||{}).value;return Object(S.jsxs)("figure",Object(o.a)(Object(o.a)({className:"flex"},t),{},{children:[n&&Object(S.jsx)("img",{src:n,alt:e}),Object(S.jsx)("figcaption",{children:e})]}))};function k(){var t=Object(s.b)(C,{devTools:!0,actions:{changeColour:Object(s.a)((function(t){document.body.style.background=t.recResult[0].utterance})),recStart:Object(s.a)((function(t){t.asr.start()})),recStop:Object(s.a)((function(t){t.asr.abort()})),ttsStart:Object(s.a)((function(t){var e='<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="http://www.w3.org/2001/mstts" xml:lang="en-US"><voice name="'.concat(t.voice.name,'">');e+=Object({NODE_ENV:"production",PUBLIC_URL:"/speechstate-lt2216",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUBSCRIPTION_KEY:"f1ad7428d15d41e99d1dc3de01674625",REACT_APP_ASR_LANGUAGE:"en-US",REACT_APP_TTS_VOICE:"en-US"}).REACT_APP_TTS_LEXICON?'<lexicon uri="'.concat(Object({NODE_ENV:"production",PUBLIC_URL:"/speechstate-lt2216",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUBSCRIPTION_KEY:"f1ad7428d15d41e99d1dc3de01674625",REACT_APP_ASR_LANGUAGE:"en-US",REACT_APP_TTS_VOICE:"en-US"}).REACT_APP_TTS_LEXICON,'"/>'):"",e+="".concat(t.ttsAgenda,"</voice></speak>"),console.debug(e);var n=new t.ttsUtterance(e);console.log("S>",t.ttsAgenda),n.voice=t.voice,n.onend=function(){return o("ENDSPEECH")},t.tts.speak(n)})),ttsStop:Object(s.a)((function(t){t.tts.cancel()})),ponyfillASR:Object(s.a)((function(t,e){var n=f()({audioContext:t.audioCtx,credentials:{region:j,authorizationToken:t.azureAuthorizationToken}}).SpeechRecognition;t.asr=new n,t.asr.lang="en-US",t.asr.continuous=!0,t.asr.interimResults=!0,t.asr.onresult=function(t){var e=t.results[0];e.isFinal?o({type:"ASRRESULT",value:[{utterance:e[0].transcript,confidence:e[0].confidence}]}):o({type:"STARTSPEECH"})}}))}}),e=Object(r.a)(t,2),n=e[0],o=e[1],c=(n.context.tdmExpectedAlternatives||[]).filter((function(t){return t.visual_information})).map((function(t,e){return Object(S.jsx)(T,{state:n,alternative:t.visual_information,onClick:function(){return o({type:"SELECT",value:t.semantic_expression})}},e)}));return Object(S.jsxs)("div",{className:"App",children:[Object(S.jsx)(R,{state:n,alternative:{},onClick:function(){return o("CLICK")}}),Object(S.jsx)("div",{className:"select-wrapper",children:Object(S.jsx)("div",{className:"select",children:c})})]})}var _=function(){return fetch(new Request("https://northeurope.api.cognitive.microsoft.com/sts/v1.0/issuetoken",{method:"POST",headers:{"Ocp-Apim-Subscription-Key":"f1ad7428d15d41e99d1dc3de01674625"}})).then((function(t){return t.text()}))},N=document.getElementById("root");c.render(Object(S.jsx)(k,{}),N)}},[[456,1,2]]]);
//# sourceMappingURL=main.7011885b.chunk.js.map